<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dota 2 Heroes Merge</title>
</head>
<body>
<h1>Dota 2 Heroes Merge</h1>
<pre id="output" style="background:#222;color:#0f0;padding:15px;"></pre>

<script>
const accountId = 863386335; // твій SteamID

async function mergeHeroes() {
  try {
    // 1. Локальні герої
    const localHeroes = await fetch("heroes.json").then(r=>r.json());

    // 2. OpenDota API
    const [playerHeroes, allHeroes] = await Promise.all([
      fetch(`https://api.opendota.com/api/players/${accountId}/heroes`).then(r=>r.json()),
      fetch("https://api.opendota.com/api/heroStats").then(r=>r.json())
    ]);

    // 3. Мапа hero_id -> localized_name
    const idToName = {};
    allHeroes.forEach(h => idToName[h.id] = h.localized_name);

    // 4. Об'єднання
    const merged = localHeroes.map(local => {
      const apiHero = playerHeroes.find(a => idToName[a.hero_id] === local.name);
      return {
        ...local,
        games: apiHero ? apiHero.games : 0,
        wins: apiHero ? apiHero.win : 0,
        myWinrate: apiHero && apiHero.games > 0
          ? ((apiHero.win / apiHero.games) * 100).toFixed(1) + "%"
          : "0%"
      };
    });

    // 5. Вивід на екран
    document.getElementById("output").textContent = JSON.stringify(merged, null, 2);

  } catch(err) {
    console.error("Помилка:", err);
    document.getElementById("output").textContent = "Помилка: " + err;
  }
}

mergeHeroes();
</script>
</body>
</html>


