<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dota 2 Draft Helper</title>
<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Fira+Sans:wght@400;600&display=swap" rel="stylesheet">

<style>
  body {
    margin: 0;
    padding: 0;
    background: url('flags/LOGO11.png') no-repeat center center fixed;
    background-size: cover;
    font-family: 'Fira Sans', sans-serif;
    color: #fff;
    text-align: center;
  }

  h1 {
    font-family: 'Press Start 2P';
    font-size: 28px;
    color: #ff0000;
    text-shadow: 0 0 10px #ff0000, 0 0 20px #aa0000;
    margin: 20px 0;
  }

  h2 {
    font-family: 'Press Start 2P';
    font-size: 16px;
    margin: 10px 0;
    color: #fff;
    text-shadow: 0 0 5px #000;
  }

  .team-container {
    display: flex;
    justify-content: center;
    gap: 20px;
    margin-bottom: 20px;
    flex-wrap: wrap;
  }

  .team {
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  .team select, .team input {
    margin: 5px 0;
    padding: 8px;
    border-radius: 8px;
    border: none;
    width: 180px;
    text-align: center;
    font-family: 'Fira Sans';
    font-size: 14px;
  }

 button {
  background: linear-gradient(to bottom, #ffcc00, #cc9900);
  color: #000;
  border: 2px solid #000;
  padding: 12px 30px;
  border-radius: 8px;
  font-weight: bold;
  font-family: 'Fira Sans';
  box-shadow: 0 0 10px #ffcc00;
  transition: all 0.2s ease;
}

button:hover {
  background: linear-gradient(to bottom, #ffaa00, #cc7700);
  transform: scale(1.05);
  box-shadow: 0 0 15px #ffaa00;
}

#resultsGrid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
  gap: 25px;
  justify-items: center;
  padding: 15px;
  margin-top: 20px;
}

.resultColumn {
  width: 100%;
  max-width: 280px;
  background: rgba(0,0,0,0.65);
  border-radius: 12px;
  padding: 12px;
  box-shadow: 0 0 10px #ffcc00;
  text-align: center;
}

.resultColumn h3 {
  margin-bottom: 8px;
  font-family: 'Press Start 2P';
  font-size: 14px;
  text-shadow: 0 0 5px #000;
}

.hero {
  background: #222;
  margin: 6px 0;
  padding: 8px 10px;
  border-radius: 10px;
  box-shadow: 0 0 6px #000;
  font-size: 13px;
}

  #stageTitle {
  font-family: 'Press Start 2P';
  font-size: 18px;
  color: #ffcc00;
  text-shadow: 0 0 10px #000, 0 0 5px #ff0000;
  margin-bottom: 15px;
}

  #teamsDisplay {
  display: flex;
  justify-content: space-between;
  flex-wrap: wrap;
  max-width: 1000px;
  margin: 20px auto;
  gap: 20px;
}

#teamsDisplay .column {
  flex: 1;                /* —É—Å—ñ –æ–¥–Ω–∞–∫–æ–≤—ñ */
  min-width: 200px;       /* —â–æ–± –Ω–µ –ª–∞–º–∞–ª–∏—Å—å –Ω–∞ –º–æ–±—ñ–ª—å–Ω–∏—Ö */
  background: rgba(0,0,0,0.7);
  padding: 15px;
  border-radius: 12px;
  box-shadow: 0 0 10px #ffcc00;
  text-align: center;
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}

#teamsDisplay .column:hover {
  transform: scale(1.04);
  box-shadow: 0 0 15px #ffaa00;
}

#teamsDisplay h3 {
  font-family: 'Press Start 2P';
  font-size: 14px;
  margin-bottom: 10px;
  color: #ffcc00;
  text-shadow: 0 0 5px #000;
}

#teamsDisplay ul {
  list-style: none;
  padding: 0;
  margin: 0;
  font-size: 14px;
}
  #draftSummary {
    display: none;
    max-width: 900px;
    margin: 20px auto;
    padding: 20px;
    background: rgba(46,46,46,0.85);
    border-radius: 15px;
    text-align: center;
  }

  #summaryContainer {
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-wrap: wrap;
  }

  #summaryMyTeam, #summaryEnemyTeam {
    list-style: none;
    padding: 0;
    width: 40%;
  }

  #summaryCenter {
    width: 20%;
  }

  #summaryBar {
    height: 20px;
    background: #ff0000;
    width: 0%;
    border-radius: 10px;
  }

  #controls {
    margin: 15px 0;
  }

  #controls input {
    margin-right: 5px;
  }

</style>
</head>

<body>
<h1>Dota 2 Draft Helper</h1>
  
<!-- üîπ –î–æ–¥–∞—î–º–æ –Ω–∞–ø–∏—Å —Å—Ç–∞–¥—ñ—ó -->
<h2 id="stageTitle">Stage 1</h2>  

<div id="selectorsContainer">


<div id="myTeam" class="team"></div>


<div id="enemyTeam" class="team"></div>

<button id="nextBtn">Go</button>

<div id="results"></div>

</div>
<div id="controls">
  <label>
    <input type="checkbox" id="behaviorMode">
    üé≠ –£–≤—ñ–º–∫–Ω—É—Ç–∏ –ø–æ–≤–µ–¥—ñ–Ω–∫–æ–≤–∏–π —Ñ–∞–∫—Ç–æ—Ä
  </label>
</div>

  <div id="teamsDisplay">
  <div class="column">
    <h3>üü¶ –ú–æ—è –∫–æ–º–∞–Ω–¥–∞</h3>
    <ul id="myTeamList"></ul>
  </div>



  <div class="column">
    <h3>üü• –°—É–ø–µ—Ä–Ω–∏–∫–∏</h3>
    <ul id="enemyTeamList"></ul>
  </div>
</div>
  <div id="draftSummary" style="display:none;">
  <div id="summaryContainer" 
       style="display:flex; justify-content:space-between; align-items:center; 
              background:url('LOGO9.png') center/cover no-repeat; 
              padding:20px; border-radius:15px; color:#fff; margin:20px auto; max-width:900px;">
    <ul id="summaryMyTeam" style="list-style:none; padding:0; text-align:center;"></ul>
    <div id="summaryCenter" style="text-align:center;">
      <h2 id="summaryChance" style="margin-bottom:10px;"></h2>
      <div style="background:rgba(0,0,0,0.5); border-radius:10px; overflow:hidden; width:150px; height:20px; margin:0 auto;">
        <div id="summaryBar" style="background:#ff0000; width:0%; height:100%;"></div>
      </div>
      <p id="summaryBehavior" style="margin-top:10px;"></p>
    </div>
    <ul id="summaryEnemyTeam" style="list-style:none; padding:0; text-align:center;"></ul>
  </div>
</div>
<div id="behaviorInfo" style="display:none; margin-top:15px; color:#ff6666;"></div>




<script>
// =========================
// üî• –í–®–ò–¢–ò–ô heroes.json
// =========================
let heroes = [];
let stage = 1;
let allMyHeroes = [];
let allEnemyHeroes = [];
const roleCategories = {
    carry: { roles: ["Carry", "Pusher", "Nuker"], weight: 3 },
    support: { roles: ["Support", "Disabler"], weight: 2 },
    universal: { roles: ["Durable", "Initiator", "Escape", "Nuker"], weight: 1 }
};
const stageLimits = [ { my: 2, enemy: 2 }, { my: 2, enemy: 2 }, { my: 1, enemy: 1 } ];
const roleWeights = { Carry:1, Disabler:0.9, Durable:0.8, Initiator:0.9, Escape:0.6, Nuker:0.7, Pusher:0.8, Support:0.9, Ranged:0.5, Melee:0.5 };

async function fetchHeroesFromOpenDota() {
    try {
        const res = await fetch('https://api.opendota.com/api/heroStats');
        const data = await res.json();
        heroes = data.map(h => ({
            id: h.id,
            name: h.localized_name,
            roles: h.roles,
            winrate: h.win / (h.pick || 1),
            pickrate: h.pick / 10000,
            BestCounters: [],
            commonCounters: []
        }));

        for (let hero of heroes) {
            try {
                const matchupRes = await fetch(`https://api.opendota.com/api/heroes/${hero.id}/matchups`);
                const matchups = await matchupRes.json();
                matchups.sort((a,b)=> a.winrate - b.winrate);
                hero.BestCounters = matchups.slice(0,10).map(m => {
                    const h = heroes.find(x=>x.id===m.hero_id);
                    return h ? h.name : '';
                });
                matchupRes.sort((a,b)=> b.winrate - a.winrate);
                hero.commonCounters = matchups.slice(0,10).map(m => {
                    const h = heroes.find(x=>x.id===m.hero_id);
                    return h ? h.name : '';
                });
            } catch(e){ console.error(hero.name, e); }
        }

        createSelectors();          // —Å—Ç–≤–æ—Ä—é—î–º–æ —Å–µ–ª–µ–∫—Ç–æ—Ä–∏ –ø—ñ—Å–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –≥–µ—Ä–æ—ó–≤
        calculateBestPicks();       // –≤—ñ–¥—Ä–∞–∑—É –ø–æ–∫–∞–∑—É—î–º–æ —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω—ñ –≥–µ—Ä–æ—ó
    } catch(e){
        console.error('–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –≥–µ—Ä–æ—ó–≤ –∑ OpenDota:', e);
    }
}

// ====================== –°–ï–õ–ï–ö–¢–û–†–ò ======================
function createSelectors() {
    const myTeamDiv = document.getElementById('myTeam');
    const enemyTeamDiv = document.getElementById('enemyTeam');
    myTeamDiv.innerHTML = "<h2>–ú–æ—è –∫–æ–º–∞–Ω–¥–∞</h2>";
    enemyTeamDiv.innerHTML = "<h2>–°—É–ø–µ—Ä–Ω–∏–∫</h2>";

    const limits = stageLimits[stage-1];
    createTeamSelectors(myTeamDiv, limits.my);
    createTeamSelectors(enemyTeamDiv, limits.enemy);

    document.getElementById('nextBtn').onclick = nextStage;
}

function createTeamSelectors(container, count) {
    const heroOptions = ['<option value="">–í–∏–±–µ—Ä–∏ –≥–µ—Ä–æ—è</option>']
        .concat(heroes.map(h=>`<option value="${h.name}">${h.name}</option>`))
        .join('');
    for (let i=0;i<count;i++){
        const wrapper = document.createElement('div');
        const input = document.createElement('input');
        const select = document.createElement('select');
        select.innerHTML = heroOptions;

        input.placeholder = '–ü–∏—à–∏ –≥–µ—Ä–æ—è...';
        input.addEventListener('input', ()=> {
            const val = input.value.trim().toLowerCase();
            const opt = Array.from(select.options).find(o=>o.text.toLowerCase().startsWith(val));
            if(opt) select.value = opt.value;
            calculateBestPicks();
        });

        select.addEventListener('change', ()=> {
            input.value = select.value;
            calculateBestPicks();
        });

        wrapper.appendChild(input);
        wrapper.appendChild(select);
        container.appendChild(wrapper);
    }
}

// ====================== –í–ò–ó–ù–ê–ß–ï–ù–ù–Ø –í–ò–ë–†–ê–ù–ò–• –ì–ï–†–û–á–í ======================
function getSelectedHeroes(selector){
    return Array.from(document.querySelectorAll(selector+' select'))
        .map(s=>s.value).filter(v=>v!=='');
}

// ====================== –ö–ê–¢–ï–ì–û–†–Ü–Ø –ì–ï–†–û–Ø ======================
function getHeroMainCategory(hero){
    const w = {carry:0,support:0,universal:0};
    hero.roles.forEach(r=>{
        for(const [cat,data] of Object.entries(roleCategories)){
            if(data.roles.includes(r)) w[cat]+=data.weight;
        }
    });
    const max = Math.max(w.carry,w.support,w.universal);
    if(max===w.carry) return 'carry';
    if(max===w.support) return 'support';
    return 'universal';
}

// ====================== –†–û–ó–†–ê–•–£–ù–û–ö –†–ï–ö–û–ú–ï–ù–î–û–í–ê–ù–ò–• –ì–ï–†–û–á–í ======================
function calculateBestPicks(){
    const myHeroes = [...allMyHeroes, ...getSelectedHeroes('#myTeam')];
    const enemyHeroes = [...allEnemyHeroes, ...getSelectedHeroes('#enemyTeam')];

    const scores = heroes.filter(h=>!myHeroes.includes(h.name) && !enemyHeroes.includes(h.name))
        .map(hero=>{
            // –ö–æ–Ω—Ç—Ä–≥–µ—Ä–æ—ó
            let counterScore=0;
            enemyHeroes.forEach(e=>{
                if(hero.BestCounters.includes(e)) counterScore+=2.5;
                else if(hero.commonCounters.includes(e)) counterScore+=1.5;
            });

            // –°–∏–Ω–µ—Ä–≥—ñ—è
            let roleCount={};
            myHeroes.forEach(name=>{
                const h=heroes.find(x=>x.name===name);
                if(h) h.roles.forEach(r=>roleCount[r]=(roleCount[r]||0)+1);
            });
            let synergy=0;
            hero.roles.forEach(r=>{
                if(roleCount[r]) synergy+=(roleWeights[r]||1)*roleCount[r];
            });

            const score = counterScore*0.5 + hero.winrate*0.3 + hero.pickrate*0.2 + synergy*0.1;
            return {hero:hero.name, score:Number(score.toFixed(3)), roles:hero.roles};
        });

    scores.sort((a,b)=>b.score-a.score);

    const categorized = scores.map(t=>({...t, category:getHeroMainCategory(heroes.find(h=>h.name===t.hero))}));

    const carryHeroes = categorized.filter(h=>h.category==='carry').slice(0,5);
    const supportHeroes = categorized.filter(h=>h.category==='support').slice(0,5);
    const universalHeroes = categorized.filter(h=>h.category==='universal').slice(0,5);

    const resultDiv=document.getElementById('results');
    resultDiv.innerHTML=`
        <h2 style="text-align:center; margin-bottom:15px;">–†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω—ñ –≥–µ—Ä–æ—ó</h2>
        <div id="resultsGrid" style="display:flex; justify-content:space-around;">
            <div class="resultColumn">
                <h3 style="color:#ffcc00;">‚öî Carry</h3>
                ${carryHeroes.map(t=>`<div class="hero">${t.hero} - ${t.score}</div>`).join('')}
            </div>
            <div class="resultColumn">
                <h3 style="color:#66ff99;">üõ° Support</h3>
                ${supportHeroes.map(t=>`<div class="hero">${t.hero} - ${t.score}</div>`).join('')}
            </div>
            <div class="resultColumn">
                <h3 style="color:#66ccff;">üîÑ Universal</h3>
                ${universalHeroes.map(t=>`<div class="hero">${t.hero} - ${t.score}</div>`).join('')}
            </div>
        </div>
    `;
}


// ====================== –ï–¢–ê–ü–ò ======================
let stage = 1;
let allMyHeroes = [];
let allEnemyHeroes = [];

function nextStage() {
    const mySelected = getSelectedHeroes('#myTeam');
    const enemySelected = getSelectedHeroes('#enemyTeam');
    const limits = stageLimits[stage - 1];
  const stageTitle = document.getElementById('stageTitle');
function updateStageTitle() {
  stageTitle.textContent = `Stage ${stage}`;
}

    // –ø–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ, —á–∏ –æ–±—Ä–∞–Ω–æ –ø–æ—Ç—Ä—ñ–±–Ω—É –∫—ñ–ª—å–∫—ñ—Å—Ç—å –≥–µ—Ä–æ—ó–≤
    if (mySelected.length < limits.my || enemySelected.length < limits.enemy) {
        alert(`‚ö†Ô∏è –û–±–µ—Ä–∏ ${limits.my} –≥–µ—Ä–æ—ó–≤ —É —Å–≤–æ—é –∫–æ–º–∞–Ω–¥—É —Ç–∞ ${limits.enemy} —É —Å—É–ø–µ—Ä–Ω–∏–∫–∞!`);
        return;
    }

    // –∑–±–µ—Ä—ñ–≥–∞—î–º–æ –≤–∏–±—Ä–∞–Ω–∏—Ö –≥–µ—Ä–æ—ó–≤
    allMyHeroes.push(...mySelected);
    allEnemyHeroes.push(...enemySelected);

    if (stage < 3) {
        stage++; // –ø–µ—Ä–µ—Ö–æ–¥–∏–º–æ –Ω–∞ –Ω–∞—Å—Ç—É–ø–Ω—É —Å—Ç–∞–¥—ñ—é
      updateStageTitle();
        updateTeamDisplays(false);
        createSelectors([], []); // —Å—Ç–≤–æ—Ä—é—î–º–æ —á–∏—Å—Ç—ñ —Å–µ–ª–µ–∫—Ç–æ—Ä–∏ –¥–ª—è –Ω–æ–≤–æ—ó —Å—Ç–∞–¥—ñ—ó
       calculateBestPicks();
showBehaviorInfo();
    } else {
        showFinalChance(); // —Ñ—ñ–Ω–∞–ª—å–Ω–∞ —Å—Ç–∞–¥—ñ—è
    }
}







// ====================== –§–Ü–ù–ê–õ ======================
// ====================== –§–Ü–ù–ê–õ ======================
function showFinalChance() {
    const myTeam = allMyHeroes;
    const enemyTeam = allEnemyHeroes;

    let myScore = 0, enemyScore = 0;

    heroes.forEach(h => {
        if (myTeam.includes(h.name)) {
            enemyTeam.forEach(e => {
                if (h.BestCounters?.includes(e)) myScore += 2;
                if (h.commonCounters?.includes(e)) myScore += 1;
            });
            myScore += h.winrate; // –¥–æ–¥–∞—î–º–æ winrate
        }
        if (enemyTeam.includes(h.name)) {
            myTeam.forEach(m => {
                if (h.BestCounters?.includes(m)) enemyScore += 2;
                if (h.commonCounters?.includes(m)) enemyScore += 1;
            });
            enemyScore += h.winrate;
        }
    });

    // —Å–∏–Ω–µ—Ä–≥—ñ—è –∫–æ–º–∞–Ω–¥
    myScore *= getTeamHarmony(myTeam);
    enemyScore *= getTeamHarmony(enemyTeam);

    let myChance = (myScore + enemyScore > 0) ? (myScore / (myScore + enemyScore)) * 100 : 50;

    // –ø–æ–≤–µ–¥—ñ–Ω–∫–æ–≤—ñ —Ñ–∞–∫—Ç–æ—Ä–∏
    if (document.getElementById('behaviorMode').checked){
        const stability = getPlayerStability();
        const influence = getRandomPlayerInfluence();
        myChance *= stability * (1 + influence);
        myChance = Math.max(5, Math.min(95, myChance));
    }

    // –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è
    document.getElementById('summaryMyTeam').innerHTML = myTeam.map(h=>`<li>üü© ${h}</li>`).join('');
    document.getElementById('summaryEnemyTeam').innerHTML = enemyTeam.map(h=>`<li>üü• ${h}</li>`).join('');
    document.getElementById('summaryChance').textContent = `–®–∞–Ω—Å –Ω–∞ –ø–µ—Ä–µ–º–æ–≥—É: ${myChance.toFixed(0)}%`;
    document.getElementById('summaryBar').style.width = `${myChance}%`;
    document.getElementById('draftSummary').style.display = 'block';
    document.getElementById('results').style.display = 'none';
  // –ø–æ–∫–∞–∑—É—î–º–æ —Ñ—ñ–Ω–∞–ª—å–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
document.getElementById('draftSummary').style.display = 'block';

// —Ö–æ–≤–∞—î–º–æ —Å–µ–ª–µ–∫—Ç–æ—Ä–∏ —Ç–∞ –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç–∞–¥—ñ—ó
document.getElementById('selectorsContainer').style.display = 'none';
document.getElementById('stageTitle').style.display = 'none';
document.getElementById('results').style.display = 'none';
document.getElementById('teamsDisplay').style.display = 'none';
document.getElementById('controls').style.display = 'none';
  // —Ç–µ–∫—Å—Ç
document.getElementById('summaryChance').textContent = `–®–∞–Ω—Å –Ω–∞ –ø–µ—Ä–µ–º–æ–≥—É: ${myChance.toFixed(0)}%`;

// —à–∫–∞–ª–∞
const bar = document.getElementById("summaryBar");
bar.style.width = `${myChance}%`;

if (myChance <= 45) {
  bar.style.background = "#f44336"; // —á–µ—Ä–≤–æ–Ω–∏–π
} else if (myChance < 55) {
  bar.style.background = "#ffeb3b"; // –∂–æ–≤—Ç–∏–π
} else {
  bar.style.background = "#4caf50"; // –∑–µ–ª–µ–Ω–∏–π
}

// –ø–æ–∫–∞–∑—É—î–º–æ –±–ª–æ–∫
document.getElementById('draftSummary').style.display = 'block';
document.getElementById('results').style.display = 'none';
 






    updateTeamDisplays(false); // –∑–∞–ª–∏—à–∞—î–º–æ –æ—Å—Ç–∞–Ω–Ω—ñ –≤–∏–±—Ä–∞–Ω—ñ –≥–µ—Ä–æ—ó –≤ —Å–ø–∏—Å–∫–∞—Ö
}
 


fetchHeroesFromOpenDota();
</script>
</body>
</html>
